# 💡 CH8. 계층형 설계 (1)

## 🛠️ 계층형 설계

### ⚙️ 소프트웨어 설계

    코드를 만들고, 테스트하고, 유지보수하기 쉬운 프로그래밍 방법을 선택하기 위해 미적 감각을 사용하는 것

### 🤔 계층형 설계란?

    - 소프트웨어를 계층으로 구성하는 기술
    - 각 계층의 함수는 바로 아래 계층에 있는 함수를 이용해 정의함

> 계층이란?

##### 🌟 계층을 잘 구분하려면, 구분하기 위한 다양한 변수를 찾고, 이를 어떻게 사용해야 하는지 알아야 함

<img src = "https://github.com/JeongwooHam/FE_Study_Logs/assets/123251211/d3e70be8-c5d6-47b2-9d9d-abd90c23a3b8" width="40%">

### 🏷️ 계층 설계의 단서가 될 입력

| 함수 본문                                                                                       |     | 계층 구조                                        |     | 함수 시그니처                                            |
| :---------------------------------------------------------------------------------------------- | :-: | :----------------------------------------------- | :-: | :------------------------------------------------------- |
| ● 길이 <br/> ● 복잡성 <br/> ● 구체화 단계 <br/> ● 함수 호출 <br/> ● 프로그래밍 언어의 기능 사용 |     | ● 화살표 길이 <br/> ● 응집도 <br/> ● 구체화 단계 |     | ● 함수명 <br/> ● 인자 이름 <br/> ● 인잣값 <br/> ● 리턴값 |

### 🔖 계층 설계의 단서가 될 출력

| 조직화                                                                       |     | 구현                                                           |     | 변경                                                                    |
| :--------------------------------------------------------------------------- | :-: | :------------------------------------------------------------- | :-: | :---------------------------------------------------------------------- |
| ● 새로운 함수를 어디에 놓을지 결정하기 <br/> ● 함수를 다른 곳으로 이동시키기 |     | ● 구현 바꾸기 <br/> ● 함수 추출하기 <br/> ● 데이터 구조 바꾸기 |     | ● 새 코드 작성할 곳 선택하기 <br/> ● 적절한 수준의 구체화 단계 결정하기 |

## 🤖 계층형 설계의 4가지 패턴

#### ✏️ Pattern1. 직접 설계하기

    직접 구현한 함수를 읽고, 함수 시그니처가 나타내고 있는 문제를 적절한 구체화 수준에서 해결하기

#### ✏️ Pattern2. 추상화 벽

    중요한 세부 구현을 감추고 인터페이스를 제공함으로써, 추상화 단계만 생각할 수 있게 하여 고차원 사고를 가능케 함

#### ✏️ Pattern3. 작은 인터페이스

    시스템이 커질수록 비즈니스 개념을 나타내는 인터페이스는 작고 강력한 동작으로 구성해주는 것이 좋음
    다른 동작들 또한 직간접적으로 최소한의 인터페이스를 유지하면서 정의해야 함

#### ✏️ Pattern4. 편리한 계층

    그냥 계층을 추가하는 것이 아니라, 코드와 그 코드가 속한 추상화 계층이 작업 시 편리할지 고민하여 추가해야 함

## ✏️ Pattern1. 직접 설계하기

### 🪡 설계 스프린트

> 고려할 사항

- 함수가 알아야 할 필요가 없는 구체적인 내용을 담고 있진 않은가?
  - 예: 마케팅 캠페인 관련 함수가 장바구니의 타입을 알아야 할까?
    - 장바구니 배열에 대한 반복문을 수행하는 과정에서 오프-바이-원 에러가 발생한다면?
    - 오프-바이-원: 배열 등을 반복해서 처리할 때 비교문을 잘못 선택해 의도치 않게 마지막 항목을 처리하지 못하거나 처리하는 오류

<br/>

- 코드에 있는 지식으로 함수가 해야 할 동작 정리하기
  - 필요한 동작을 나열하고, 구현된 것 체크해보기

<br/>

- 저수준의 코드(반복문)은 추출해야 할 가능성이 높음
  - 개선된 함수는 짧고 명확함
  - 비슷한 구체화 수준에서 작동하게 되므로 가독성이 좋음

### 📊 호출 그래프를 만들어 함수 호출을 시각화하기

<img src = "https://github.com/JeongwooHam/FE_Study_Logs/assets/123251211/4a4eba5b-5661-446a-9f9f-a75b3ede35e8" width="40%">

- 수정 전 함수의 호출 그래프
- 위처럼, 서로 다른 추상화 단계에 있는 기능을 사용하면 직접 구현 패턴이 아님

<img src = "https://github.com/JeongwooHam/FE_Study_Logs/assets/123251211/81bea58c-c2ad-436d-b850-1853073aaee6" width="40%">

- 수정 후 함수의 호출 그래프
- 개선된 함수는 더 가까운 추상화 계층을 호출하므로, 직접 구현에 가까워짐
