# 💡 CH18. 반응형 아키텍쳐와 어니언 아키텍쳐

```
두 개의 결합된 액션에서,
하나의 액션이 수정되면 결합된 다른 액션의 모든 것을 변경하거나 복제해야하는 문제가 생기는 경우가 있다.
🤔 이를 어떻게 해결할 수 있을까?
```

## ⚒️ 반응형 아키텍처

- 애플리케이션을 구조화는 방법
- 순차적 액션 단계에 사용
- 코드에 나타난 순차적 액션의 순서를 뒤집는다.
- 효과와 그 효과에 대한 원인을 분리하여 코드의 복잡한 부분을 풀 수 있다.
- **이벤트에 대한 반응으로 일어날 일을 지정한다.**
- 웹 서비스와 UI에 잘 어울린다.
  - 웹 서비스: 웹 요청 응답에 일어날 일을 지정한다.
  - UI: 버튼 클릭과 같은 이벤트 응답에 일어날 일을 지정한다. ➡️ **_EVENT HANDLER_**

### 🤖 이벤트 핸들러의 동작 과정

1. X, Y, Z, A, B, C를 순서대로 수행할 경우 반응형 아키텍처는 하려고 하는 것만 처리한다.
2. 모든 것은 어떤 일이 일어나면 그에 대한 응답으로 처리한다.
   - X가 일어나면 Y, Y가 일어나면 Z, ...

> 이벤트 핸들러 예제

|                              웹 서비스                              |                  사용자 인터페이스                   |
| :-----------------------------------------------------------------: | :--------------------------------------------------: |
|                           **요청 핸들러**                           |                  **이벤트 핸들러**                   |
|             핸들러는 웹 요청에 대한 응답으로 동작한다.              |     핸들러는 UI 이벤트에 대한 응답으로 동작한다.     |
| DB에서 가격 읽기, 장바구니 가격 변경, <br/> 합계 합산, 웹 응답 전송 | 전역 장바구니에 제품 추가, <br/> DOM/아이콘 업데이트 |

- 원래 핸들러 함수에서 순서대로 실행되던 것을 여러 개의 핸들러에서 실행되도록 나눈 것!

### 🗝️ 반응형 아키텍처의 절충점

- 반응형 아키텍처는 코드에 나타난 순차적 액션의 순서를 뒤집는다.
  - 예) X를 하고 Y를 하는 대신, X가 일어나면 언제나 Y를 한다.
- 코드의 가독성이 쉬워지고 유지보수에 용이하다.
- 언제, 어떻게 사용할지는 스스로 판단해야 한다.

### 💫 함수형 프로그래밍과 변경 가능한 상태

> 👀 **감시자(watcher)**

- 상태가 바뀔 때마다 실행되는 핸들러 함수
- ≒ 이벤트 핸들러, 옵저버, 콜백, 리스너

```
👩‍🏫 반응형 아키텍처는 코드에 어떤 영향을 미쳤을까요?
```

### 1️⃣ 원인과 효과가 결합된 것을 분리한다.

```
상황에 따라 원인과 효과를 분리하는 것이 가독성을 떨어트릴 수도 있고, 코드를 유연하고 명확하게 만들수도 있다.
```

> 결합의 분리는 원인와 효과의 중심을 관리한다.

### 2️⃣ 여러 단계를 파이프라인으로 처리한다.

```
함수형 도구를 연결해 만든 파이프라인으로 데이터 변환 과정을 처리할 수 있었다.
반응형 아키텍처로도 이와 비슷하게 액션과 계산을 조합할 수 있다.
```

### 3️⃣ 타임라인이 유연해진다.

```
순서를 표현하는 방법을 뒤집으면 타임라인이 유연해진다.
유연성으로 인해 예상치 못한 순서로 실행될 수도 있지만, 익숙해지면 더 짧은 타임라인을 만들 수 있다.
```

## 🧅 어니언 아키텍처

- 서비스의 모든 단계에 사용
- 웹 서비스, 온도 조절 장치 등 현실 세계와 상호작용하기 위한 서비스 구조를 만든다.
- 함수형 사고 적용 시 자연스럽게 쓸 수 있다.

### 🚨 전통적인 계층형 아키텍처

### 🤖 함수형 아키텍처

### 📢 변경과 재사용이 쉬워야 한다!

### 📑 도메인 규칙과 도메인 용어

### 👓 가독성 따져보기
