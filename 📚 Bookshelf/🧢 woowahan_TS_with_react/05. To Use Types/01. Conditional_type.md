## ğŸ› ï¸ ì¡°ê±´ë¶€ íƒ€ì…

- ì¡°ê±´ë¶€ íƒ€ì…ì„ ì ì ˆíˆ í™œìš©í•˜ë©´ ì¤‘ë³µë˜ëŠ” íƒ€ì… ì½”ë“œë¥¼ ì œê±°í•˜ê³  ìƒí™©ì— ë”°ë¼ ì ì ˆí•œ íƒ€ì…ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.
- ë”ìš± ì •í™•í•œ íƒ€ì… ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ë‹¤.

### `extends`ì™€ ì œë„¤ë¦­ì„ í™œìš©í•œ ì¡°ê±´ë¶€ íƒ€ì…

```ts
type PayMethod<T> = T extends U ? X : Y;
type TargetMethodType = PayMethod<U>;
```

- `T extends U ? X : Y`
  - `T`ë¥¼ `U`ì— í• ë‹¹í•  ìˆ˜ ìˆìœ¼ë©´ `X` íƒ€ì…, ì•„ë‹ˆë©´ `Y` íƒ€ì…ìœ¼ë¡œ ê²°ì •ëœë‹¤.

### ì¡°ê±´ë¶€ íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œì˜ ë¬¸ì œì 

- **CASE)** ë¹„ìŠ·í•œ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ê°€ì§€ëŠ” ì„¸ ê°€ì§€ì˜ API
  - ì„œë²„ ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ê³µí†µ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ê³  í•´ë‹¹ í•¨ìˆ˜ì— íƒ€ì…ì„ ì „ë‹¬í•´ íƒ€ì…ë³„ë¡œ ì²˜ë¦¬ ë¡œì§ì„ êµ¬í˜„í•œë‹¤.
  - `PayMethodInfo<T extends Bank | Card>`
    - UI ë°ì´í„° íƒ€ì…ê³¼ ì œë„¤ë¦­ìœ¼ë¡œ ë°›ì•„ì˜¤ëŠ” Bank ë˜ëŠ” Cardë¥¼ í•©ì„±í•œë‹¤.
    - `extends`ë¥¼ ì œë„¤ë¦­ì—ì„œ í•œì •ìë¡œ ì‚¬ìš©í•˜ì—¬ Bank ë˜ëŠ” Cardë¥¼ í¬í•¨í•˜ì§€ ì•ŠëŠ” íƒ€ì…ì€ ì œë„¤ë¦­ìœ¼ë¡œ ë„˜ê²¨ì£¼ì§€ ëª»í•˜ê²Œ ë°©ì–´í•œë‹¤.
    - `BankPayMethodInfo = PayMethodInterface & Bank`ì™€ ê°™ì´ ì¹´ë“œì™€ ì€í–‰ì˜ íƒ€ì…ì„ ë§Œë“¤ì–´ì£¼ëŠ” ëŒ€ì‹  ì œë„¤ë¦­ì„ í™œìš©í•´ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•œë‹¤.

> ì˜ˆì‹œ ì½”ë“œ

```ts
type PayMethodType = PayMethodInfo<Card> | PayMethodInfo<Bank>;

// í•´ë‹¹ ê²°ì œìˆ˜ë‹¨ì˜ ê²°ì œìˆ˜ë‹¨ ì •ë³´ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
export const useGetRegisteredList = (
  type: "card" | "appCard" | "bank"
): UseQueryResult<PayMethodType[]> => {
  const url = `~/${type === "appCard" ? "card" : type}`;

  // fetcherFactory: wrapping axios. ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ í›„ onSuccess ì½œë°±í•¨ìˆ˜ë¥¼ ê±°ì¹œ ê²°ê³¼ê°’ì„ ë°˜í™˜í•œë‹¤.
  const fetcher = fetcherFactory<PayMethodType[]>({
    onSuccess: (res) => {
      const usablePocketList =
        res?.filter(
          (pocket: PocketInfo<Card> | PocketInfo<Bank>) =>
            pocket?.useType === "USE"
        ) ?? [];
      return usablePocketList;
    },
  });

  // useCommonQuery<T>: useQueryì˜ ë°˜í™˜ dataë¥¼ Tíƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
  const result = useCommonQuery<PayMethodType[]>(url, undefined, fetcher);

  // useQueryì˜ ë°˜í™˜ ê°’ return
  return result;
};
```

- ë°˜í™˜í•˜ëŠ” ë°ì´í„°ëŠ” `PocketInfo<Card> | PocketInfo<Bank>`
  - íƒ€ì…ì„ êµ¬ë¶„í•´ì„œ ë„£ëŠ” ì‚¬ìš©ìì˜ ì˜ë„ì™€ëŠ” ë‹¤ë¥´ê²Œ íƒ€ì… ì„¤ì •ì´ ìœ ë‹ˆì˜¨ìœ¼ë¡œë§Œ ë˜ì–´ ìˆì–´ í•´ë‹¹ íƒ€ì…ì— ë§ëŠ” í…Œì´í„° íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ì—†ë‹¤.

```
ğŸ‘©â€ğŸ« ì´ëŸ´ ë•Œ extendsë¥¼ í†µí•´ ì¡°ê±´ë¶€ íƒ€ì…ì„ êµ¬í˜„í•˜ì—¬ ì¸ìì— ë”°ë¼ ë°˜í™˜ë˜ëŠ” íƒ€ì…ì„ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
```

### `extends` ì¡°ê±´ë¶€ íƒ€ì…ì„ í™œìš©í•˜ì—¬ ê°œì„ í•˜ê¸°

> ê°œì„ ëœ íƒ€ì…

```ts
type PayMethodType<T extends "card" | "appCard" | "bank"> = T extends
  | "card"
  | "appCard"
  ? Card
  : Bank;
```

- ì œë„¤ë¦­ìœ¼ë¡œ ë°›ì€ ê°’ì´ `card` ë˜ëŠ” `appCard`ì´ë©´ `PayMethodInfo<Card>` íƒ€ì…, ì•„ë‹ˆë©´ `PayMethodInfo<Bank>` íƒ€ì…ì„ ë°˜í™˜í•œë‹¤.
- ê²°ì œ ìˆ˜ë‹¨ì—ì„œ `extends`ë¥¼ í•œì •ìë¡œ í™œìš©í•´ ì œë„¤ë¦­ì— ë„˜ê²¨ì˜¤ëŠ” ê°’ì„ `card`, `appCard`, `bank`ë¡œ ì œí•œí•œë‹¤.

> ê°œì„ ëœ í•¨ìˆ˜

```ts
// ì¡°ê±´ë¶€ íƒ€ì…ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ PayMethodTypeì´ ì‚¬ìš©ìê°€ ì¸ìì— ë„£ëŠ” íƒ€ì… ê°’ì— ë§ëŠ” íƒ€ì…ë§Œ ë°˜í™˜í•˜ê²Œ ëœë‹¤.
export const useGetRegisteredList = <T extends "card" | "appCard" | "bank">(
  type: T
): UseQueryResult<PayMethodType<T>[]> => {
  // ... ì´ì „ê³¼ ë™ì¼

  const fetcher = fetcherFactory<PayMethodType<T>[]>({
    // ...
  });

  const result = useCommonQuery<PayMethodType<T>[]>(url, undefined, fetcher);
  return result;
};
```

> `extends` í™œìš© ì˜ˆì‹œ

1. ì œë„¤ë¦­ê³¼ `extends`ë¥¼ í•¨ê»˜ í™œìš©í•´ ì œë„¤ë¦­ìœ¼ë¡œ ë°›ëŠ” íƒ€ì…ì„ ì œí•œí•˜ì—¬ ì˜ëª»ëœ ê°’ì„ ë„˜ê¸¸ ìˆ˜ ì—†ê²Œ í•œë‹¤. (íœ´ë¨¼ ì—ëŸ¬ ë°©ì§€)
2. `extends`ë¥¼ í™œìš©í•´ ì¡°ê±´ë¶€ íƒ€ì…ì„ ì„¤ì •í•˜ì—¬ ë°˜í™˜ ê°’ì„ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê°’ìœ¼ë¡œ êµ¬ì²´í™”í•œë‹¤. (ë¶ˆí•„ìš”í•œ íƒ€ì… ê°€ë“œ, íƒ€ì… ë‹¨ì–¸ ë“± ë°©ì§€)

### `infer`ë¥¼ í™œìš©í•´ì„œ íƒ€ì… ì¶”ë¡ í•˜ê¸°

```ts
type UnpackPromise<T> = T extends Promise<infer K>[] ? K : any;
```

- `extends`ë¡œ ì¡°ê±´ì„ ì„œìˆ í•˜ê³  `infer`ë¡œ íƒ€ì…ì„ ì¶”ë¡ í•œë‹¤.
  - ì œë„¤ë¦­ìœ¼ë¡œ `T`ë¥¼ ë°›ì•„ `T`ê°€ Promiseë¡œ wrappingëœ ê²½ìš° `K`ë¥¼ ë°˜í™˜í•˜ê³  ì•„ë‹ˆë©´ `any`ë¥¼ ë°˜í™˜í•œë‹¤.
  - `Promise<infer K>`: Promiseì˜ ë°˜í™˜ê°’ì„ ì¶”ë¡ í•´ í•´ë‹¹ ê°’ì˜ íƒ€ì…ì„ `K`ë¡œ í•œë‹¤.
- **CASE)** ë©”ë‰´ ë¦¬ìŠ¤íŠ¸ì—ì„œ ê±´í•œ APIë¥¼ í†µí•´ ë°˜í™˜ëœ ì‚¬ìš©ì ê¶Œí•œê³¼ `name`ì„ ë¹„êµí•´ ì‚¬ìš©ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë©”ë‰´ë§Œ ë Œë”ë§í•˜ëŠ” ê²½ìš°
  - ë¼ìš°íŒ…ì„ ìœ„í•´ ë™ì¼í•œ ë¬¸ìì—´ë§Œ ì…ë ¥í•´ì•¼ í•˜ì§€ë§Œ ë‹¨ìˆœíˆ `string`ìœ¼ë¡œë§Œ ì§€ì •í•  ê²½ìš° ì„œë¡œ ë‹¤ë¥¸ ê°’ì´ ì…ë ¥ë˜ì–´ë„ ì»´íŒŒì¼ íƒ€ì„ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
  - ëŸ°íƒ€ì„ì—ì„œë„ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¶Œí•œì— ëŒ€í•œ ë¬¸ì œë¡œ ì˜ëª» ì¸ì§€í•  ìˆ˜ ìˆë‹¤.

> ğŸ¤” ë‹¨ìˆœíˆ ë³„ë„ íƒ€ì…ì„ ì§€ì •í•˜ì—¬ ê°œì„ í•œë‹¤ë©´?

```ts
type PermissionNames = "aaaa" | "bbbb" | "cccc";
```

- ìœ„ì™€ ê°™ì´ í—ˆê°€ëœ `name`ë§Œ ë³„ë„ íƒ€ì…ìœ¼ë¡œ ì§€ì •í•  ê²½ìš° ê¶Œí•œ ê²€ì‚¬ê°€ í•„ìš” ì—†ê±°ë‚˜ `pages`ê°€ ì¡´ì¬í•˜ëŠ” `name`ì€ ë”°ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

```
ğŸ‘©â€ğŸ« inferì™€ ë¶ˆë³€ ê°ì²´(as const)ë¥¼ í™œìš©í•´ ë¬¸ì œë¥¼ í•´ê²°í•´ë´…ì‹œë‹¤!
```

> `menuList` ê°’ ì¶”ì¶œ ì˜ˆì‹œ

```ts
export interface MainMenu {
  // ...
  subMenus?: ReadonlyArray<SubMenu>; // readonly ë°°ì—´ë¡œ ë³€ê²½
}
// ë¶ˆë³€ ê°ì²´ë¡œ ì •ì˜
export const menuList = [
  /*...*/
] as const;

interface RouteBase {
  // ...
}

export type RouteItem =
  | { name: string; path: string; pages: RouteBase[] }
  // route ê´€ë ¨ íƒ€ì…ì˜ nameì€ menuListì˜ nameì—ì„œ ì¶”ì¶œí•œ íƒ€ì…ì¸ PermissionNamesë§Œ ì˜¬ ìˆ˜ ìˆë„ë¡ ë³€ê²½
  | { name: PermissionNames; path: string };

// ë¶ˆë³€ ê°ì²´ì¸ MenuItem ë°°ì—´ë§Œ ì…ë ¥ìœ¼ë¡œ ë°›ë„ë¡ ì œí•œë˜ì–´ ìˆë‹¤. > infer Uë¡œ ë°°ì—´ ë‚´ë¶€ íƒ€ì… ì¶”ë¡ 
type UnpackMenuNames<T extends ReadonlyArray<MenuItem>> =
  T extends ReadonlyArray<infer U>
    ? // Uê°€ MainMenu íƒ€ì…ì´ë©´ subMenusë¥¼ infer Vë¡œ ì¶”ì¶œí•œë‹¤.
      U extends MainMenu
      ? // subMenusëŠ” optionalí•œ ê°’ì´ë¯€ë¡œ ì¶”ì¶œí•œ Vê°€ ì¡´ì¬í•˜ë©´(SubMenu íƒ€ì…ì— í• ë‹¹í•  ìˆ˜ ìˆìœ¼ë©´) > UnpackMenuNamesì— ë‹¤ì‹œ ì „ë‹¬
        U["subMenus"] extends infer V
        ? V extends ReadonlyArray<SubMenu>
          ? UnpackMenuNames<V>
          : // Vê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ MainMenuì˜ nameì€ ê¶Œí•œì— í•´ë‹¹í•œë‹¤.
            U["name"]
        : never
      : // í• ë‹¹ ê°€ëŠ¥í•˜ë©´ UëŠ” SubMenu íƒ€ì…ì´ë¯€ë¡œ U['name']ì€ ê¶Œí•œì— í•´ë‹¹í•œë‹¤.
      U extends Submenu
      ? U["name"]
      : never
    : never;
```

- `PermissionNames`ëŠ” `menuList`ì—ì„œ ìœ íš¨í•œ ê°’ë§Œ ì¶”ì¶œí•˜ì—¬ ë°°ì—´ë¡œ ë°˜í™˜í•˜ëŠ” íƒ€ì…ì´ ëœë‹¤.

```ts
export type PermissionNames = UnpackMenuNames<typeof menuList>;
```
